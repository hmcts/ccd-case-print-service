{"actions":[],"advisories":{"1111087":{"findings":[{"version":"4.21.2","paths":["express"]}],"found_by":null,"deleted":null,"references":"- https://github.com/expressjs/express/security/advisories/GHSA-pj86-cfqh-vqx6\n- https://github.com/expressjs/express/commit/2f64f68c37c64ae333e41ff38032d21860f22255\n- https://github.com/expressjs/express/releases/tag/4.22.0\n- https://github.com/expressjs/express/releases/tag/v5.2.0\n- https://nvd.nist.gov/vuln/detail/CVE-2024-51999\n- https://github.com/advisories/GHSA-pj86-cfqh-vqx6","created":"2025-12-01T18:59:17.000Z","id":1111087,"npm_advisory_id":null,"overview":"### Impact\n\nwhen using the extended query parser in express (`'query parser': 'extended'`), the `request.query` object inherits all object prototype properties, but these properties can be overwritten by query string parameter keys that match the property names\n\n> [!IMPORTANT]  \n> the extended query parser is the default in express 4; this was changed in express 5 which by default uses the simple query parser\n\n### Patches\n\nthe issue has been patched to ensure `request.query` is a plain object so `request.query` no longer has object prototype properties. this brings the default behavior of extended query parsing in line with express's default simple query parser\n\n### Workaround\n\nthis only impacts users using extended query parsing (`'query parser': 'extended'`), which is the default in express 4, but not express 5.  all users are encouraged to upgrade to the patched versions, but can otherwise work around this issue:\n\n#### provide `qs` directly and specify `plainObjects: true`\n\n```js\napp.set('query parser',\n  function (str) {\n    return qs.parse(str, {\n      plainObjects: true\n  });\n});\n```","reported_by":null,"title":"express improperly controls modification of query properties","metadata":null,"cves":["CVE-2024-51999"],"access":"public","severity":"low","module_name":"express","vulnerable_versions":"<4.22.0","github_advisory_id":"GHSA-pj86-cfqh-vqx6","recommendation":"Upgrade to version 4.22.0 or later","patched_versions":">=4.22.0","updated":"2025-12-02T00:25:17.000Z","cvss":{"score":0,"vectorString":null},"cwe":["CWE-915"],"url":"https://github.com/advisories/GHSA-pj86-cfqh-vqx6"}},"muted":[],"metadata":{"vulnerabilities":{"info":0,"low":1,"moderate":0,"high":0,"critical":0},"dependencies":30,"devDependencies":1,"optionalDependencies":0,"totalDependencies":31}}
